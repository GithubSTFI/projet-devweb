<div class="auth-container">
    <!-- Animated Background -->
    <div class="animated-bg">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
        <div class="particles">
            <span class="particle" *ngFor="let p of [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]"></span>
        </div>
    </div>

    <!-- Glass Container -->
    <div class="glass-card" [@cardAnimation]>
        <!-- Toggle Pills -->
        <div class="mode-toggle">
            <button [class.active]="!isSignUpMode" (click)="setMode(false)" class="toggle-btn">
                Connexion
            </button>
            <button [class.active]="isSignUpMode" (click)="setMode(true)" class="toggle-btn">
                Inscription
            </button>
            <div class="toggle-pill" [class.right]="isSignUpMode"></div>
        </div>

        <!-- Logo & Title -->
        <div class="header-section" [@fadeSlide]>
            <div class="logo-badge">
                <span class="material-icons">bolt</span>
            </div>
            <h1 class="title">{{ isSignUpMode ? 'Créer un compte' : 'Bon retour' }}</h1>
            <p class="subtitle">{{ isSignUpMode ? 'Rejoignez TaskFlow et boostez votre productivité' : 'Connectez-vous
                pour continuer votre aventure' }}</p>
        </div>

        <!-- Forms Container -->
        <div class="forms-wrapper">
            <!-- LOGIN FORM -->
            <form *ngIf="!isSignUpMode" [formGroup]="loginForm" (ngSubmit)="onLogin()" [@formSlide] class="auth-form">

                <div class="input-wrapper">
                    <div class="input-icon">
                        <span class="material-icons">person_outline</span>
                    </div>
                    <input type="text" formControlName="username" placeholder="Identifiant"
                        [class.error]="fLog['username'].touched && fLog['username'].invalid" class="premium-input">
                    <div class="input-line"></div>
                </div>
                <div class="error-text" *ngIf="fLog['username'].touched && fLog['username'].errors">
                    <span *ngIf="fLog['username'].errors['required']">Identifiant requis</span>
                </div>

                <div class="input-wrapper">
                    <div class="input-icon">
                        <span class="material-icons">lock_outline</span>
                    </div>
                    <input type="password" formControlName="password" placeholder="Mot de passe"
                        [class.error]="fLog['password'].touched && fLog['password'].invalid" class="premium-input">
                    <div class="input-line"></div>
                </div>
                <div class="error-text" *ngIf="fLog['password'].touched && fLog['password'].errors">
                    <span *ngIf="fLog['password'].errors['required']">Mot de passe requis</span>
                </div>

                <div class="form-footer">
                    <label class="remember-me">
                        <input type="checkbox">
                        <span>Se souvenir</span>
                    </label>
                    <a href="#" class="forgot-link">Mot de passe oublié ?</a>
                </div>

                <button type="submit" [disabled]="loginForm.invalid" class="premium-btn">
                    <span class="btn-text">Se connecter</span>
                    <span class="btn-icon material-icons">arrow_forward</span>
                    <div class="btn-glow"></div>
                </button>

                <p *ngIf="loginError" class="error-alert">{{ loginError }}</p>
            </form>

            <!-- SIGNUP FORM -->
            <form *ngIf="isSignUpMode" [formGroup]="registerForm" (ngSubmit)="onRegister()" [@formSlide]
                class="auth-form">

                <div class="input-wrapper">
                    <div class="input-icon">
                        <span class="material-icons">person_outline</span>
                    </div>
                    <input type="text" formControlName="username" placeholder="Nom d'utilisateur"
                        [class.error]="fReg['username'].touched && fReg['username'].invalid" class="premium-input">
                    <div class="input-line"></div>
                </div>
                <div class="error-text" *ngIf="fReg['username'].touched && fReg['username'].errors">
                    <span *ngIf="fReg['username'].errors['required']">Nom requis</span>
                    <span *ngIf="fReg['username'].errors['minlength']">Minimum 3 caractères</span>
                </div>

                <div class="input-wrapper">
                    <div class="input-icon">
                        <span class="material-icons">email</span>
                    </div>
                    <input type="email" formControlName="email" placeholder="Email"
                        [class.error]="fReg['email'].touched && fReg['email'].invalid" class="premium-input">
                    <div class="input-line"></div>
                </div>
                <div class="error-text" *ngIf="fReg['email'].touched && fReg['email'].errors">
                    <span *ngIf="fReg['email'].errors['required']">Email requis</span>
                    <span *ngIf="fReg['email'].errors['email']">Format email invalide</span>
                </div>

                <div class="input-wrapper">
                    <div class="input-icon">
                        <span class="material-icons">lock_outline</span>
                    </div>
                    <input type="password" formControlName="password" placeholder="Mot de passe"
                        [class.error]="fReg['password'].touched && fReg['password'].invalid" class="premium-input">
                    <div class="input-line"></div>
                </div>
                <div class="error-text" *ngIf="fReg['password'].touched && fReg['password'].errors">
                    <span *ngIf="fReg['password'].errors['required']">Mot de passe requis</span>
                    <span *ngIf="fReg['password'].errors['minlength']">Minimum 6 caractères</span>
                </div>

                <div class="input-wrapper">
                    <div class="input-icon">
                        <span class="material-icons">verified_user</span>
                    </div>
                    <input type="password" formControlName="confirmPassword" placeholder="Confirmer le mot de passe"
                        [class.error]="fReg['confirmPassword'].touched && fReg['confirmPassword'].invalid"
                        class="premium-input">
                    <div class="input-line"></div>
                </div>
                <div class="error-text" *ngIf="fReg['confirmPassword'].touched && fReg['confirmPassword'].errors">
                    <span *ngIf="fReg['confirmPassword'].errors['required']">Confirmation requise</span>
                    <span *ngIf="fReg['confirmPassword'].errors['mismatch']">Mots de passe différents</span>
                </div>

                <button type="submit" [disabled]="registerForm.invalid" class="premium-btn">
                    <span class="btn-text">Créer mon compte</span>
                    <span class="btn-icon material-icons">arrow_forward</span>
                    <div class="btn-glow"></div>
                </button>

                <p *ngIf="registerError" class="error-alert">{{ registerError }}</p>
            </form>
        </div>

        <!-- Footer -->
        <div class="card-footer">
            <p class="footer-text">
                En continuant, vous acceptez nos
                <a href="#">Conditions d'utilisation</a> et notre
                <a href="#">Politique de confidentialité</a>
            </p>
        </div>
    </div>

    <!-- Bottom Badge -->
    <div class="bottom-badge">
        <span class="material-icons">verified</span>
        <span>Sécurisé par TaskFlow</span>
    </div>
</div>